# V2: データ保存とプライバシー要件

## 制御目標

ユーザの認証情報や個人情報などの機密データの保護はモバイルセキュリティの最重要点である。第一に、もしIPCのようなオペレーティングシステムメカニズムが不適切に使用されているなら、機密データが意図せずに同じデバイス上で実行されている他のアプリに漏えいする可能性がある。データが意図せずプラットフォームのストレージやバックアップ、キーボードキャッシュに漏れるかもしれない。その上、モバイルデバイスは他種類のデバイスと比べて簡単に紛失、盗難されるので、物理アクセスを得ている敵はよりうまくいきそうなシナリオである。その場合には、機密データの回収をより困難にするために、追加の保護が実現される可能性がある。

ここで留意すべきは、MASVSはアプリ中心であるため、MDMソリューションによって実施されるようなデバイスレベルのポリシーはカバーしないということである。我々は、データセキュリティをさらに強化するために、企業背景でそのようなポリシーの使用を推奨している。

### 機密データの定義

MASVSのコンテキストでの機密データは、以下のようなユーザ認証情報や特定の状況で機密と考えられるその他のデータの両方に関係する。

- 個人情報泥棒のために悪用される可能性がある個人情報(PII)：社会保障番号、クレジットカード番号、銀行口座番号、保険関連情報
- 漏えいした場合に、評判の悪化および/または財務費用が発生するような高機密データ： 契約情報、機密保持契約に含まれている情報、管理情報
- 法律やコンプライアンスの理由によって保護されなければならないすべてのデータ

## セキュリティ検証要件

データ開示問題の大部分は、簡単なルールに従うことで防ぐことができる。本章に記載されている制御のほとんどは、すべての検証標準で必須事項である。

| # | 説明 | L1 | L2 |
| --- | --- | --- | --- |
| **2.1** | システム認証情報保存機関が、ユーザ認証情報や暗号鍵などの機密データを保存するために適切に使用されている | ✓ | ✓ |
| **2.2** | ログファイルに機密データが記述されていない | ✓ | ✓ |
| **2.3** | アーキテクチャの不必要な部分なら、機密データが第三者に共有されない | ✓ | ✓ |
| **2.4** | 機密データを処理するテキスト入力でキーボードキャッシュが無効化されている | ✓ | ✓ |
| **2.5** | 機密データを含んでいるかもしれないテキストフィールドでクリップボードが停止されている | ✓ | ✓ |
| **2.6** | 機密データがIPCメカニズムを介して公開されていない | ✓ | ✓ |
| **2.7** | パスワードやPINなどの機密データがユーザインタフェースを通して公開されていない | ✓ | ✓ |
| **2.8** | 機密データがモバイルオペレーティングシステムによって作成されたバックアップに含まれていない |   | ✓ |
| **2.9** | バックグラウンドにいるとき、アプリが機密データをビュー(画面表示用データ)から削除する |  | ✓ |
| **2.10** | アプリが機密データを必要以上に長い時間メモリ上に保持しない、また機密データの使用後にメモリが明示的にクリアされる |  | ✓ |
| **2.11** | ユーザに端末のパスコードを設定するなどの最小限のデバイスアクセスセキュリティポリシーをアプリが実施する |  | ✓ |
| **2.12** | アプリが加工された個人情報の種類だけではなく、そのアプリを使用する際にユーザが従うべきであるセキュリティのベストプラクティスについてユーザを教育する |  | ✓ |

## 参考文献

OWASP モバイルセキュリティテストガイドは、本セクションに記載されている要件を検証するための詳細な指示を提供する。

- For Android - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md
- For iOS - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md

詳細は以下参照：

- OWASP Mobile Top 10: M2  - Insecure Data Storage(安全でないデータ保存): https://www.owasp.org/index.php/Mobile_Top_10_2016-M2-Insecure_Data_Storage
- CWE: https://cwe.mitre.org/data/definitions/922.html
