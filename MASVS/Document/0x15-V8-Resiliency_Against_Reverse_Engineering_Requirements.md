# V8: リバースエンジニアリングに対する耐性要件

## 制御目的

本セクションは、機密データや機能を処理したりアクセスを与えたりするアプリに推奨される多層防御手段を含む。これらの制御のうち、何かが不足していたとしても脆弱性を引き起こさない。代わりに、それらはリバースエンジニアリングや特定のクライアントサイドの攻撃に対するアプリの耐性を向上させることを意味する。

本セクションの制御は、アプリの認可されていない改ざんおよび/またはコードのリバースエンジニアリングによって引き起こされるリスクの評価に基づいたニーズとして適用されるべきである。関連した技術的脅威だけでなくビジネスリスクのリストに関して、我々はOWASPのドキュメントである「リバースエンジニアリングや不正なコード変更の技術的リスク リバースエンジニアリングとコード改ざん防止」(以下の参考文献を参照のこと)を参考にすることを提案する。

以下のリストの制御のいくつかが効果的であるために、アプリは少なくともMASVS-L1(すなわち、適所に堅牢なセキュリティ制御がなされているに違いない)と同様にV8の若い番号のすべてを達成しなければならない。たとえば、「理解防止」の下に記載されている難読化制御は、「アプリの分離」、「動的解析と改ざんの防止」、「デバイスバインド」と組み合わせられなければならない。

**ソフトウェア制御はセキュリティ制御の代わりに決して使用してはならないことに注意すること。MASVS-Rに記載されている制御は、MASVSセキュリティ要件を達成しているアプリに特定脅威の更なる保護制御を追加することを意味する。**

以下の考慮が適用される。

1. 脅威モデルは、防御する対象のクライアント側の脅威を明確に述べる定義をされなければならない。加えて、スキームが提供するはずの保護グレードは指定されなければならない。例えば、規定された目標は、重要な手動のリバースエンジニアリングの努力をつぎ込むためのアプリをインストルメント化しようとすることを標的とされたマルウェアの製作者に強制される可能性がある。

2. 脅威モデルは合理的でなければならない。たとえば、攻撃者が簡単にホワイトボックス全体をコードリフトすることができる場合、ホワイトボックス実装で暗号鍵を隠すことは的外れである。

3. 保護の有効性は、特定の種類の使用された改ざん対策と難読化のテストの経験と共に人間の専門家によって常に検証されるべきである(モバイルセキュリティテストガイドの「リバースエンジニアリング」と「ソフトウェア保護の評価」の章も参照のこと)。

### 動的解析や改ざんの妨害

| # | 説明 | R |
| --- | --- | --- |
| **8.1** | ユーザへの警告やアプリを終了することによって、アプリはroot化された、もしくはJailbreakされたデバイスの存在を検出して応答する | ✓ |
| **8.2** | アプリはデバッグを防止し、取り付けられているデバッガを検出して応答する。利用可能なすべてのデバッグプロトコルがカバーされていなければならない | ✓ |
| **8.3** | アプリが自身のサンドボックス内の実行可能ファイルや重要なデータが改ざんされたことを検出して応答する | ✓ |
| **8.4** | T広く使用されているリバースエンジニアリングツールとフレームワークがデバイス上に存在するかをアプリが検出して応答する | ✓ |
| **8.5** | エミュレータ上で実行されているかをアプリが検出して応答する | ✓ |
| **8.6** | 自身のメモリ空間にあるコードとデータの改ざんをアプリが検出して応答する | ✓ |
| **8.7** | アプリがそれぞれの防御カテゴリ(8.1～8.6)に複数のメカニズムを実装する。回復力は総量、使用されるメカニズムのオリジナリティの多様性に対応することに注意しなさい | ✓ |
| **8.8** | 検出メカニズムは、遅延型や内密な応答を含む異なるタイプの応答を動作させる | ✓ |
| **8.9** | 難読化はプログラムチックな防御に適用され、動的解析による難読化解除を妨害する | ✓ |

### デバイスバインド

| # | 説明 | R |
| --- | --- | --- |
| **8.10** | アプリがデバイス特有の複数のプロパティから生成されたデバイスフィンガープリントを用いて「デバイスバインド」機能を実装する | ✓ |

### 理解防止

| # | 説明 | R |
| --- | --- | --- |
| **8.11** | アプリに属している実行可能なファイルとライブラリのすべては、ファイルレベルで暗号化されているか、実行ファイル内の重要なコードとデータセグメントが暗号化もしくはパックされている。普通の静的解析では、重要なコードやデータは明らかにならない | ✓ |
| **8.12** | 難読化の目的が機微な計算を保護することである場合は、現在発表されている調査を考慮した手動の難読化解除メソッドや自動化された難読化解読メソッドに対して、特定の作業に適した堅固な難読化スキームが使用されている。難読化スキームの有効性は、手動のテストを通して検証されていなければならない。可能な限り、ハードウェアベースの分離機能が難読化よりも好まれることに注意すること | ✓ |

## 参考文献

OWASP モバイルセキュリティテストガイドは、本セクションに記載されている要件を検証するための詳細な指示を提供する。

- Android - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05j-Testing-Resiliency-Against-Reverse-Engineering.md
- iOS - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06j-Testing-Resiliency-Against-Reverse-Engineering.md

詳細は以下参照：

- OWASP Mobile Top 10: M8 - Code Tampering(コード改ざん), M9 - Reverse Engineering(リバースエンジニアリング)
- WASP Reverse Engineering Threats -https://www.owasp.org/index.php/Technical_Risks_of_Reverse_Engineering_and_Unauthorized_Code_Modification
- OWASP Reverse Engineering and Code Modification Prevention - https://www.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project
