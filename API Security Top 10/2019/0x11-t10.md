OWASP Top 10 API Security Risks – 2019
======================================

| Risk | Description |
| ---- | ----------- |
| API1:2019 - Broken Object Level Authorization (オブジェクトレベルの認可の不備) | API は、オブジェクト識別子を処理するエンドポイントを公開する傾向があり、これにより、広域のアタックサーフェイスレベルのアクセス制御問題を引き起こす。オブジェクトレベルの認可チェックは、ユーザからの入力を用いてデータソースにアクセスする機能全てで考慮されるべきである。 |
| API2:2019 - Broken User Authentication (認証の不備) | 認証メカニズムは大抵間違って実装されるため、攻撃者は認証トークンの漏えいや実装の不備を悪用することで、一時的もしくは恒久的に他ユーザの識別子を推測することが可能となる。クライアント/ユーザを識別するシステムの機能を侵害されることにより、API のセキュリティ全体が侵害されてしまう。 |
| API3:2019 - Excessive Data Exposure (データの過剰な公開) | 一般的な実装を期待して、開発者は個々の機微性を考慮することなく、オブジェクトの属性全てを公開する傾向があり、ユーザに表示する前にクライアントがデータのフィルタリングを行うことを当てにしている。クライアントの状態を制御することなく、サーバは機微データへのアクセスを取得するために悪用される可能性のあるフィルターをますます受け入れてしまう。 |
| API4:2019 - Lack of Resources & Rate Limiting (リソース不足と帯域制限) | ほとんどの場合、API はクライアント/ユーザが要求できるリソースのサイズや数に制限を課すことはない。これは、API サーバのパフォーマンスに影響を与えるサービス拒否 (DoS) につながるだけではなく、ブルートフォースのような認証の欠陥につながる穴を放置していることでもある。 |
| API5:2019 - Broken Function Level Authorization (機能レベルの認可の不備) | 様々な階層、グループや役割、また管理機能と通常機能の不明瞭な区別があるような複雑なアクセス制御ポリシーは、認可の欠陥につながりやすい。これらの問題を悪用することで、攻撃者は他ユーザのリソースや管理機能へのアクセスを取得することができる。 |
| API6:2019 - Mass Assignment (一括割り当て) | クライアントが提供するデータ (JSON など) をデータモデルに対してバインドすることは、ホワイトリストに基づいた適当なプロパティのフィルタリングが行われないため、通常、一括割り当てにつながる。オブジェクトのプロパティの推測、他の API エンドポイントの調査、ドキュメントの読み込み、もしくはリクエストペイロードでのオブジェクトプロパティの追加提供により、攻撃者はサポートされていないオブジェクトプロパティを改ざんすることができる。 |
| API7:2019 - Security Misconfiguration (セキュリティ設定ミス) | 通常の場合、セキュリティ設定ミスは、安全でないデフォルト設定、不十分もしくはその場しのぎな設定、公開されているクラウドストレージ、HTTP ヘッダの設定ミス、不必要な HTTP メソッド、オリジン間リソース共有 (CORS) の許容、機微情報を含む詳細なエラーメッセージの結果である。 |
| API8:2019 - Injection (インジェクション) | SQL インジェクション、NoSQL インジェクション、コマンドインジェクションなどのようなインジェクションの欠陥は、信頼できないデータがコマンドやクエリの一部としてインタプリタに送られることによって引き起こされる。攻撃者の悪意あるデータはインタプリタを騙して、正常な認可なしに意図しないコマンド実行やデータへのアクセスを行うことができる。 |
| API9:2019 - Improper Assets Management (不適切な資産管理) | API は、従来の Web アプリケーションと比べて、より多くのエンドポイントを公開する傾向があり、適切で更新されたドキュメントを非常に重要とする。適切なホストとデプロイされた API バージョンの一覧表は、廃止予定の API バージョンや公開されたデバッグエンドポイントなどの問題を軽減するための重要な役割も果たす。 |
| API10:2019 - Insufficient Logging & Monitoring (不十分なロギングとモニタリング) | 不十分なロギングとモニタリングは、インシデント対応との統合不足や非効率な組み合わせと相まって、攻撃者がさらなるシステムに攻撃を行い、永続性を維持し、より多くのシステムの中核となることで、データの改ざん、抽出、破壊を可能とする。リスク調査のほとんどは、侵害の検出に 200 日以上かかっていることを示しており、通常の場合、内部プロセスやモニタリングよりはむしろ、外部の関係者によって検出されている。 |
